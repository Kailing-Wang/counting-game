<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <title>å¿ƒå¹³æ°£å’Œ æ•¸ç§’å™¨</title>
    <style>
        body {
            font-family: "Segoe UI", sans-serif;
            background: #f0f4f8;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 50px;
        }

        h1 {
            color: #333;
        }

        #game-box {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        button {
            font-size: 18px;
            margin: 10px;
            padding: 12px 30px;
            border: none;
            border-radius: 5px;
            background-color: #0078d4;
            color: white;
            cursor: pointer;
        }

        button:disabled {
            background-color: #999;
            cursor: not-allowed;
        }

        #result {
            margin-top: 20px;
            font-size: 16px;
            color: #444;
        }

        #targetTime {
            font-size: 28px;
            font-weight: bold;
            color: #cc3300;
            margin-bottom: 15px;
            transition: transform 0.3s ease;
        }

        #leaderboard-box {
            margin-top: 40px;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 90%;
            max-width: 400px;
        }

        #leaderboard-box h2 {
            margin-bottom: 10px;
        }

        #leaderboard {
            list-style: none;
            padding: 0;
        }

        #leaderboard li {
            margin: 5px 0;
        }
    </style>
</head>

<body>
    <h1>å¿ƒå¹³æ°£å’Œ æ•¸ç§’å™¨</h1>
    <div id="game-box">
        <div id="targetTime"></div>
        <p id="status">æº–å‚™é–‹å§‹éŠæˆ²ï¼</p>
        <button id="startBtn" onclick="startChallenge()">é–‹å§‹</button>
        <button id="stopBtn" onclick="stopChallenge()" disabled>åœæ­¢</button>
        <div id="result"></div>
    </div>

    <div id="leaderboard-box">
        <h2>æ’è¡Œæ¦œï¼ˆèª¤å·®æœ€å°ï¼‰</h2>
        <ul id="leaderboard"></ul>
    </div>

    <script>
        const stages = [
            { name: "æš–èº«è¨“ç·´ï¼ˆå…±å…©æ¬¡ï¼‰", count: 2, min: 5, max: 10 },
            { name: "æ­£å¼æŒ‘æˆ°ï¼ˆå…±ä¸€æ¬¡ï¼‰", count: 1, min: 15, max: 20 }
        ];

        let currentStage = 0;
        let currentTrial = 0;
        let targetSeconds = 0;
        let startTime = 0;
        let isRunning = false;
        let stageErrors = [];

        function getRandomSeconds(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function startChallenge() {
            const stage = stages[currentStage];
            targetSeconds = getRandomSeconds(stage.min, stage.max);

            // é‡ç½®ç•«é¢
            document.getElementById("targetTime").textContent = `é€™é¡Œè«‹æ•¸ ${targetSeconds} ç§’`;
            document.getElementById("result").textContent = "";
            document.getElementById("startBtn").disabled = true;
            document.getElementById("stopBtn").disabled = true;
            document.getElementById("status").textContent = `${stage.name} - ç¬¬ ${currentTrial + 1} æ¬¡`;

            // é¡¯ç¤ºç›®æ¨™ç§’æ•¸å¾Œå€’æ•¸
            setTimeout(() => {
                let count = 3;
                const countdown = setInterval(() => {
                    if (count > 0) {
                        document.getElementById("targetTime").textContent = count;
                    } else if (count === 0) {
                        document.getElementById("targetTime").textContent = "é–‹å§‹ï¼";
                        startTime = Date.now();
                        isRunning = true;
                        document.getElementById("stopBtn").disabled = false;
                        document.getElementById("status").textContent = `é–‹å§‹è¨ˆæ™‚ï½æŒ‰ã€Œåœæ­¢ã€çµæŸ`;
                    }
                    count--;
                }, 1000);
            }, 1000);
        }

        function stopChallenge() {
            if (!isRunning) return;

            const elapsed = (Date.now() - startTime) / 1000;
            const error = Math.abs(elapsed - targetSeconds);
            const stageName = stages[currentStage].name;

            document.getElementById("result").innerHTML =
                `ä½ æ•¸äº† ${elapsed.toFixed(2)} ç§’<br>ç›®æ¨™æ˜¯ ${targetSeconds} ç§’<br>èª¤å·®ï¼š${error.toFixed(2)} ç§’`;

            stageErrors.push(error);
            isRunning = false;
            currentTrial++;
            document.getElementById("startBtn").disabled = false;
            document.getElementById("stopBtn").disabled = true;

            if (currentTrial >= stages[currentStage].count) {
                const avgError = stageErrors.reduce((a, b) => a + b, 0) / stageErrors.length;
                setTimeout(() => {
                    alert(`${stageName} å®Œæˆï¼ç¸½èª¤å·®ï¼š${avgError.toFixed(2)} ç§’`);

                    // æ‰€æœ‰é—œå¡çµæŸ
                    if (currentStage === stages.length - 1) {
                        const finalAvg = avgError;
                        const name = prompt("éŠæˆ²å®Œæˆï¼æ‚¨çœŸæ˜¯æ™‚é–“æŒæ§å¤§å¸«ğŸ˜Šè«‹è¼¸å…¥åå­—ä¸Šæ’è¡Œæ¦œï¼š");
                        if (name) saveToLeaderboard(name, finalAvg);
                        document.getElementById("status").textContent = "æ­å–œå®ŒæˆæŒ‘æˆ°";
                        document.getElementById("startBtn").disabled = true;
                    } else {
                        // é€²å…¥ä¸‹ä¸€é—œ
                        currentStage++;
                        currentTrial = 0;
                        stageErrors = [];
                        document.getElementById("status").textContent = `${stages[currentStage].name} å³å°‡é–‹å§‹ï¼`;
                        document.getElementById("result").textContent = "";
                    }
                }, 1000);
            }
        }

        function saveToLeaderboard(name, averageError) {
            const key = 'leaderboard';
            let list = JSON.parse(localStorage.getItem(key) || '[]');
            list.push({ name, averageError });
            list.sort((a, b) => a.averageError - b.averageError);
            list = list.slice(0, 10);
            localStorage.setItem(key, JSON.stringify(list));
            renderLeaderboard();
        }

        function renderLeaderboard() {
            const listEl = document.getElementById('leaderboard');
            const list = JSON.parse(localStorage.getItem('leaderboard') || '[]');
            listEl.innerHTML = list.length ? '' : '<li>å°šç„¡ç´€éŒ„</li>';
            list.forEach((e, i) => {
                const li = document.createElement('li');
                li.textContent = `${i + 1}. ${e.name} - èª¤å·® ${e.averageError.toFixed(2)} ç§’`;
                listEl.appendChild(li);
            });
        }

        // åˆæ¬¡è¼‰å…¥é¡¯ç¤º
        document.addEventListener('DOMContentLoaded', renderLeaderboard);
    </script>
</body>

</html>

<!-- 
## â±ï¸ å¿ƒå¹³æ°£å’Œ æ•¸ç§’å™¨

é€™æ˜¯ä¸€å€‹ç°¡å–®çš„è®€ç§’æŒ‘æˆ°éŠæˆ²ï¼Œç©å®¶éœ€è¦åœ¨å¿ƒä¸­é»˜æ•¸ï¼ŒæŒ‘æˆ°è‡ªå·±çš„æ™‚é–“æ„ŸçŸ¥èƒ½åŠ›ï¼

## ğŸ® éŠæˆ²è¦å‰‡

1. æŒ‰ä¸‹ã€Œé–‹å§‹ã€æŒ‰éˆ•å¾Œï¼Œç•«é¢å°‡é¡¯ç¤ºæ­¤æ¬¡çš„ç›®æ¨™è®€ç§’æ•¸ã€‚
2. ä¸‰ç§’çš„å€’æ•¸æº–å‚™ï¼Œç•¶ä½ è¦ºå¾—æ™‚é–“åˆ°äº†ï¼Œå°±æŒ‰ä¸‹ã€Œåœæ­¢ã€æŒ‰éˆ•ã€‚
3. ç¨‹å¼æœƒå‘Šè¨´ä½ å¯¦éš›ç¶“éçš„ç§’æ•¸ï¼Œä¸¦è¨ˆç®—èª¤å·®ã€‚

## ğŸ¯ é—œå¡è¨­è¨ˆ

æš–èº«è¨“ç·´  2 æ¬¡
æ­£å¼æŒ‘æˆ°  1 æ¬¡

- éŠæˆ²å°‡ä¾åºé€²è¡Œå…©æ¬¡æš–èº«èˆ‡ä¸€æ¬¡æ­£å¼æŒ‘æˆ°
- èª¤å·®æˆç¸¾æœ€æ¥è¿‘è€…æœƒè¨˜éŒ„åœ¨æ’è¡Œæ¦œä¸­ï¼æ­¡è¿æŒ‘æˆ°ï½ -->